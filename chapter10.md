# Chapter 10: 标定技术

激光雷达的测量精度不仅取决于硬件设计，更取决于精确的标定。标定是将传感器的原始测量值转换为准确物理量的关键过程，直接影响到点云质量、多传感器融合精度以及最终的应用效果。本章将深入探讨激光雷达的内参标定、外参标定以及在线自标定技术，提供详细的数学模型和实用算法。

## 10.1 内参标定

内参标定解决激光雷达自身的系统误差，包括测距误差、角度误差和温度漂移等。这些误差源于制造公差、装配精度和环境因素。

### 10.1.1 测距误差模型

激光雷达的测距误差通常呈现系统性偏差和比例误差：

$$d_{true} = a \cdot d_{meas} + b + \epsilon(d)$$

其中：
- $a$：比例因子（理想值为1）
- $b$：固定偏差（单位：米）
- $\epsilon(d)$：与距离相关的非线性误差

**标定方法：**

1. **线性最小二乘法**
   
   采集N个标定点$(d_{meas,i}, d_{true,i})$，构建超定方程组：
   
   $$\begin{bmatrix} d_{meas,1} & 1 \\ d_{meas,2} & 1 \\ \vdots & \vdots \\ d_{meas,N} & 1 \end{bmatrix} \begin{bmatrix} a \\ b \end{bmatrix} = \begin{bmatrix} d_{true,1} \\ d_{true,2} \\ \vdots \\ d_{true,N} \end{bmatrix}$$
   
   最小二乘解：
   $$\begin{bmatrix} a \\ b \end{bmatrix} = (A^T A)^{-1} A^T D_{true}$$

2. **非线性误差建模**
   
   对于高精度应用，需考虑非线性项：
   $$d_{true} = a \cdot d_{meas} + b + c \cdot d_{meas}^2 + d \cdot \sin(\frac{2\pi d_{meas}}{\lambda_{mod}})$$
   
   其中最后一项表示调制波长引起的周期性误差。

**实例计算：**

假设采集了5个标定点：
- $(10m, 10.05m)$, $(20m, 20.08m)$, $(30m, 30.12m)$, $(40m, 40.14m)$, $(50m, 50.18m)$

构建矩阵：
$$A = \begin{bmatrix} 10 & 1 \\ 20 & 1 \\ 30 & 1 \\ 40 & 1 \\ 50 & 1 \end{bmatrix}, \quad D_{true} = \begin{bmatrix} 10.05 \\ 20.08 \\ 30.12 \\ 40.14 \\ 50.18 \end{bmatrix}$$

计算$A^T A$：
$$A^T A = \begin{bmatrix} 5500 & 150 \\ 150 & 5 \end{bmatrix}$$

求解得：
$$a = 1.0034, \quad b = 0.018m$$

### 10.1.2 角度编码器校正

机械旋转式激光雷达的角度测量依赖于编码器，其误差模型：

$$\theta_{true} = \theta_{meas} + \Delta\theta_{offset} + A_{\theta} \sin(n\theta_{meas} + \phi_{\theta})$$

其中：
- $\Delta\theta_{offset}$：零位偏差
- $A_{\theta}$：周期性误差幅值
- $n$：编码器齿数
- $\phi_{\theta}$：相位偏移

**标定过程：**

1. **静态目标法**
   
   将激光雷达对准已知角度的标定板阵列，记录测量角度与真实角度的对应关系。
   
2. **自标定法**
   
   利用重复扫描同一静态场景，通过最小化点云配准误差来优化角度参数：
   
   $$\min_{\Delta\theta, A_{\theta}, \phi_{\theta}} \sum_{i,j} \|P_i(\theta + \delta\theta) - P_j(\theta)\|^2$$

**实际案例：**

某64线激光雷达，编码器分辨率0.1°，实测发现：
- 零位偏差：$\Delta\theta_{offset} = 0.23°$
- 周期性误差：$A_{\theta} = 0.05°$，周期为360°/1024（编码器线数）

校正后角度精度从±0.15°提升至±0.03°。

### 10.1.3 温度补偿表

温度变化影响测距精度和机械结构，需建立温度补偿模型：

$$d_{comp} = d_{meas} \cdot [1 + \alpha_T(T - T_{ref})] + \beta_T(T - T_{ref})^2$$

**温度标定实验：**

1. **控温实验**
   
   在温控箱中，温度范围-40°C至+85°C，每10°C采集一组数据：
   
   | 温度(°C) | 10m目标测距(m) | 50m目标测距(m) |
   |----------|----------------|----------------|
   | -40      | 9.982          | 49.915         |
   | -20      | 9.991          | 49.957         |
   | 0        | 9.998          | 49.992         |
   | 20       | 10.000         | 50.000         |
   | 40       | 10.003         | 50.016         |
   | 60       | 10.008         | 50.041         |
   | 85       | 10.015         | 50.074         |

2. **补偿系数计算**
   
   通过拟合得到：
   - 线性系数：$\alpha_T = 3.2 \times 10^{-5}/°C$
   - 二次系数：$\beta_T = 8.5 \times 10^{-8}/°C^2$

### 10.1.4 多回波时序校正

对于支持多回波的激光雷达，不同回波通道可能存在时序偏差：

$$t_{corrected,i} = t_{measured,i} + \Delta t_i + \gamma_i \cdot (t_{measured,i} - t_{first})$$

其中：
- $\Delta t_i$：第i个回波的固定延迟
- $\gamma_i$：与首次回波时间差相关的比例因子

**标定方法：**

使用不同距离的漫反射目标，确保只产生单次回波，测量各通道的时间偏差。

### 10.1.5 激光功率校正

不同激光通道的功率差异影响最大探测距离和反射率计算：

$$P_{normalized,i} = P_{measured,i} \cdot K_i \cdot f(T)$$

其中$K_i$为第i个通道的功率校正系数。

**功率均衡标定：**

1. 使用标准反射率靶标（如10%、50%、90%）
2. 固定距离下测量各通道返回信号强度
3. 计算校正系数使所有通道响应一致

### 10.1.6 综合标定流程

完整的内参标定流程：

1. **环境准备**
   - 标定场地：长度>100m，宽度>20m
   - 标准靶标：不同反射率和距离
   - 温控设备：覆盖工作温度范围

2. **数据采集**
   ```
   for 温度 in [-40°C, -20°C, 0°C, 20°C, 40°C, 60°C, 85°C]:
       for 距离 in [5m, 10m, 20m, 30m, 50m, 80m, 100m]:
           for 反射率 in [10%, 50%, 90%]:
               采集1000帧数据
               记录：测量距离、真实距离、信号强度、温度
   ```

3. **参数优化**
   
   构建总体误差函数：
   $$E_{total} = w_d E_{distance} + w_{\theta} E_{angle} + w_T E_{temp} + w_P E_{power}$$
   
   使用Levenberg-Marquardt算法优化所有标定参数。

4. **验证测试**
   - 静态精度：RMSE < 2cm @ 50m
   - 动态精度：相对误差 < 1%
   - 温度稳定性：漂移 < 1cm/10°C

## 10.2 外参标定

外参标定确定激光雷达在载体坐标系中的位置和姿态，对于多传感器系统至关重要。外参包括3个平移参数$(t_x, t_y, t_z)$和3个旋转参数（通常用欧拉角$(\phi, \theta, \psi)$或四元数表示）。

### 10.2.1 手眼标定问题

激光雷达外参标定可归结为经典的AX=XB问题：

$$T_{base}^{target} \cdot T_{lidar}^{base} = T_{lidar}^{base} \cdot T_{lidar}^{target}$$

简化为：
$$AX = XB$$

其中：
- $A = T_{base,i}^{base,j}$：载体在不同位置间的变换
- $B = T_{lidar,i}^{lidar,j}$：激光雷达观测到的相对变换
- $X = T_{lidar}^{base}$：待求的外参矩阵

### 10.2.2 基于特征的标定方法

**1. 棋盘格标定板法**

使用大型棋盘格标定板，同时被相机和激光雷达观测：

标定步骤：
1. 相机检测棋盘格角点，计算位姿$T_{camera}^{board}$
2. 激光雷达提取平面，拟合得到$T_{lidar}^{board}$
3. 已知相机-载体外参$T_{camera}^{base}$，求解：
   $$T_{lidar}^{base} = T_{camera}^{base} \cdot T_{camera}^{board} \cdot (T_{lidar}^{board})^{-1}$$

**2. 三面体角反射器法**

使用角反射器作为高精度控制点：

角反射器在点云中表现为高强度点，位置精度可达毫米级。通过多个角反射器构建约束：

$$\min_{R,t} \sum_{i=1}^{n} \|R \cdot p_i^{lidar} + t - p_i^{base}\|^2$$

其中$p_i^{base}$为角反射器在基准坐标系中的已知位置。

### 10.2.3 最小二乘解法

对于过约束的标定问题，使用SVD分解求解：

**旋转矩阵求解：**

1. 计算质心：
   $$\bar{p}^{lidar} = \frac{1}{n}\sum_{i=1}^{n} p_i^{lidar}, \quad \bar{p}^{base} = \frac{1}{n}\sum_{i=1}^{n} p_i^{base}$$

2. 去质心：
   $$q_i^{lidar} = p_i^{lidar} - \bar{p}^{lidar}, \quad q_i^{base} = p_i^{base} - \bar{p}^{base}$$

3. 构建协方差矩阵：
   $$H = \sum_{i=1}^{n} q_i^{lidar} \cdot (q_i^{base})^T$$

4. SVD分解：
   $$H = U\Sigma V^T$$

5. 计算旋转矩阵：
   $$R = V \cdot \text{diag}(1, 1, \det(VU^T)) \cdot U^T$$

**平移向量求解：**
$$t = \bar{p}^{base} - R \cdot \bar{p}^{lidar}$$

### 10.2.4 标定不确定度分析

外参标定的不确定度来源于：

1. **测量噪声传播**
   
   根据误差传播定律：
   $$\Sigma_{X} = J_f \Sigma_{obs} J_f^T$$
   
   其中$J_f$为雅可比矩阵，$\Sigma_{obs}$为观测协方差。

2. **几何配置影响**
   
   DOP（Dilution of Precision）因子：
   $$DOP = \sqrt{\text{trace}((A^T A)^{-1})}$$
   
   DOP值越小，标定精度越高。

**实例分析：**

某车载系统标定结果：
- 平移精度：$\sigma_t = [2.1mm, 1.8mm, 3.2mm]$
- 旋转精度：$\sigma_R = [0.05°, 0.04°, 0.08°]$（roll, pitch, yaw）

通过蒙特卡洛仿真（1000次），验证标定不确定度：
```
for i in range(1000):
    添加高斯噪声到观测点
    重新计算外参
    记录与真值的偏差
计算标准差作为不确定度估计
```

### 10.2.5 多激光雷达系统标定

当系统包含多个激光雷达时，需要标定相互之间的外参：

**重叠区域配准法：**

1. 识别重叠区域点云
2. 使用ICP或NDT算法配准：
   $$T_{lidar2}^{lidar1} = \arg\min_{R,t} \sum_{i} \|R \cdot p_i^{lidar2} + t - p_i^{lidar1}\|^2$$

3. 考虑时间同步，补偿运动畸变

**全局优化：**

构建因子图，同时优化所有激光雷达外参：
$$\min \sum_{i<j} \|T_i \cdot T_{ij}^{measured} - T_j\|_{\Sigma_{ij}}^2$$

### 10.2.6 动态外参标定

对于移动平台，考虑振动和形变的影响：

$$T_{lidar}^{base}(t) = T_{static} \cdot \exp(\sum_{k=1}^{n} \xi_k \sin(2\pi f_k t + \phi_k))$$

其中$\xi_k$为第k阶振动模态的李代数表示。

**在线估计方法：**

使用扩展卡尔曼滤波器(EKF)实时估计外参变化：

状态向量：$x = [t_x, t_y, t_z, \phi, \theta, \psi, \dot{t}_x, ..., \dot{\psi}]^T$

状态转移：
$$x_{k+1} = f(x_k) + w_k$$

观测方程：
$$z_k = h(x_k) + v_k$$

其中观测量来自点云配准残差。

### 10.2.7 标定质量评估

**1. 重投影误差**

将激光点投影到相机图像，计算像素误差：
$$e_{reproj} = \frac{1}{N}\sum_{i=1}^{N} \|u_i - \pi(K[R|t]p_i^{lidar})\|$$

良好标定应满足：$e_{reproj} < 2$ pixels

**2. 点云重叠一致性**

多激光雷达系统中，评估重叠区域的一致性：
$$e_{overlap} = \frac{1}{N}\sum_{i=1}^{N} \min_{j} \|p_i^{lidar1} - T_{lidar2}^{lidar1} \cdot p_j^{lidar2}\|$$

目标：$e_{overlap} < 5cm$

**3. 闭环一致性检验**

对于多传感器链式标定：
$$e_{loop} = \|T_1^2 \cdot T_2^3 \cdot ... \cdot T_n^1 - I\|_F$$

理想情况下$e_{loop} \approx 0$。

## 10.3 在线自标定

在线自标定技术使激光雷达系统能够在运行过程中自动检测和补偿标定参数的变化，无需专门的标定设备和流程。这对于长期运行的自动驾驶车辆和机器人系统尤为重要。

### 10.3.1 SLAM反馈校正

利用SLAM算法的优化结果反向校正传感器参数：

**原理：**
SLAM构建的地图质量直接反映标定精度。通过最小化地图不一致性来优化标定参数。

**实现框架：**

1. **扩展状态向量**
   
   将标定参数加入SLAM状态：
   $$X = [x_1, ..., x_n, \theta_{calib}]^T$$
   
   其中$x_i$为位姿，$\theta_{calib}$为标定参数。

2. **联合优化**
   
   成本函数：
   $$J = \sum_{i,j} e_{ij}^T \Omega_{ij} e_{ij} + \sum_k e_k^T \Lambda_k e_k$$
   
   第一项为位姿约束，第二项为观测约束。

3. **在线更新**
   
   使用滑动窗口，仅优化最近N帧：
   ```
   while(运行中):
       新建关键帧
       if 关键帧数 > N:
           构建局部图优化问题
           优化位姿和标定参数
           更新全局标定值
   ```

**实例：外参在线校正**

某自动驾驶车辆运行1000km后，通过SLAM反馈发现：
- Yaw角漂移：0.15°（由于安装松动）
- Z轴偏移：8mm（由于悬挂系统变化）

自动校正后，定位精度从15cm提升至5cm。

### 10.3.2 平面特征提取与利用

城市环境中存在大量平面特征（地面、墙面、标志牌），可用于在线标定：

**地面约束：**

假设地面方程为$ax + by + cz + d = 0$，归一化后$c = -1$：
$$z = ax + by + d$$

对于正确标定的系统，地面点应满足此约束。构建优化问题：
$$\min_{\theta_{calib}} \sum_{i \in ground} (ax_i + by_i + z_i - d)^2$$

**垂直面约束：**

建筑物立面通常垂直于地面：
$$n_{wall} \cdot n_{ground} = 0$$

利用此约束校正Roll和Pitch角。

**实时平面检测算法：**

1. **体素降采样**：减少计算量
2. **法向量估计**：使用PCA计算每点的法向量
3. **区域生长**：相似法向量的点聚类
4. **RANSAC拟合**：鲁棒的平面参数估计

```
平面检测伪代码：
for each 体素:
    计算协方差矩阵
    特征值分解得到法向量
    if 最小特征值 < 阈值:
        标记为平面候选点
使用区域生长聚类平面点
RANSAC拟合平面参数
```

### 10.3.3 标定质量指标

**1. 点云配准残差**

定义瞬时配准质量：
$$Q_{reg}(t) = \frac{1}{\sqrt{\frac{1}{N}\sum_{i=1}^{N} d_i^2}}$$

其中$d_i$为最近点距离。$Q_{reg}$下降表示标定退化。

**2. 平面拟合残差**

$$Q_{plane}(t) = \frac{1}{\sigma_{plane}}$$

$\sigma_{plane}$为平面拟合的标准差。

**3. 重复观测一致性**

对于静态场景的重复观测：
$$Q_{repeat}(t) = \exp(-\frac{\|P_t - P_{t-\Delta t}\|_F}{\sigma_0})$$

**综合质量指标：**
$$Q_{total} = w_1 Q_{reg} + w_2 Q_{plane} + w_3 Q_{repeat}$$

当$Q_{total} < Q_{threshold}$时触发重新标定。

### 10.3.4 自适应标定触发机制

**1. 阈值触发**
```
if Q_total < 0.8:
    触发精细标定
elif Q_total < 0.9:
    触发快速标定
```

**2. 周期性检查**
- 每运行100km执行快速检查
- 每运行1000km执行完整标定验证

**3. 事件触发**
- 检测到剧烈振动（IMU数据）
- 温度变化超过20°C
- 系统重启后

### 10.3.5 快速在线标定算法

**最小参数化方法：**

仅优化最可能变化的参数（如z轴高度和yaw角）：

$$\theta_{quick} = [z, \psi]^T$$

优化问题简化为2D：
$$\min_{z,\psi} \sum_i \|p_i^{transformed} - p_i^{reference}\|^2$$

使用牛顿法快速收敛：
$$\theta_{k+1} = \theta_k - \alpha H^{-1} g$$

其中$H$为Hessian矩阵，$g$为梯度。

**计算优化：**
- 使用kd-tree加速最近邻搜索
- GPU并行计算点云变换
- 仅使用关键点（corner, edge features）

典型运行时间：<100ms/帧

### 10.3.6 多传感器协同标定

**激光雷达-IMU协同：**

IMU提供高频姿态信息，用于检测标定变化：
$$\Delta R_{lidar} = R_{IMU}(t_2) \cdot R_{IMU}^{-1}(t_1) \cdot \Delta R_{measured}^{-1}$$

理想情况$\Delta R_{lidar} = I$，偏差表示外参变化。

**激光雷达-相机协同：**

利用语义信息提升标定精度：
1. 相机识别车道线、交通标志
2. 激光雷达提取对应几何特征
3. 最小化语义-几何对应误差

### 10.3.7 标定参数存储与管理

**版本控制：**
```json
{
  "calibration_history": [
    {
      "timestamp": "2024-01-15T10:30:00Z",
      "version": "1.2.3",
      "parameters": {
        "translation": [0.5, 0.0, 1.8],
        "rotation_euler": [0.1, 0.05, 0.02],
        "confidence": 0.95
      },
      "trigger": "periodic",
      "validation_metrics": {
        "reprojection_error": 1.2,
        "overlap_consistency": 0.03
      }
    }
  ]
}
```

**参数平滑：**

避免标定参数突变：
$$\theta_{applied} = \alpha \theta_{new} + (1-\alpha) \theta_{old}$$

其中$\alpha = \min(1, \frac{\Delta t}{\tau})$，$\tau$为时间常数。

### 10.3.8 失败保护机制

**1. 标定合理性检查**
```
if |translation_change| > 10cm or |rotation_change| > 2°:
    拒绝更新
    记录异常日志
    使用上一个有效标定
```

**2. 多源验证**
- 与GPS/RTK数据对比
- 与高精地图匹配验证
- 与其他传感器交叉验证

**3. 降级策略**
- Level 0: 使用在线优化的标定
- Level 1: 使用最近的可信标定
- Level 2: 使用出厂标定
- Level 3: 安全停车，等待人工干预

## 本章小结

本章系统介绍了激光雷达的标定技术，涵盖内参标定、外参标定和在线自标定三个核心方面：

**关键概念：**
1. **内参标定**：校正系统固有误差
   - 测距误差模型：$d_{true} = a \cdot d_{meas} + b$
   - 温度补偿：考虑环境因素的影响
   - 多通道一致性：确保所有激光通道的测量一致性

2. **外参标定**：确定传感器间的相对位姿
   - 手眼标定问题：$AX = XB$
   - SVD最小二乘解法：鲁棒的数学求解方法
   - 不确定度分析：量化标定精度

3. **在线自标定**：运行时自动维护标定精度
   - SLAM反馈：利用地图质量优化标定
   - 平面特征约束：利用环境几何信息
   - 质量监控：实时评估标定状态

**重要公式汇总：**
- 测距标定：$d_{true} = a \cdot d_{meas} + b + \epsilon(d)$
- 旋转求解：$R = V \cdot \text{diag}(1, 1, \det(VU^T)) \cdot U^T$
- 质量指标：$Q_{total} = w_1 Q_{reg} + w_2 Q_{plane} + w_3 Q_{repeat}$
- 参数平滑：$\theta_{applied} = \alpha \theta_{new} + (1-\alpha) \theta_{old}$

**实践要点：**
- 标定精度直接影响系统性能，需定期验证
- 温度变化是标定漂移的主要原因
- 在线自标定可显著提升长期运行的可靠性
- 多传感器系统需考虑时间同步问题

## 练习题

### 基础题

**1. 测距误差标定**
某激光雷达在10m、30m、50m处测得距离分别为10.12m、30.35m、50.59m。使用最小二乘法计算比例因子a和偏差b。

*Hint: 构建矩阵方程$Ax = b$，其中$A$为测量值矩阵。*

<details>
<summary>答案</summary>

构建方程组：
$$\begin{bmatrix} 10.12 & 1 \\ 30.35 & 1 \\ 50.59 & 1 \end{bmatrix} \begin{bmatrix} a \\ b \end{bmatrix} = \begin{bmatrix} 10 \\ 30 \\ 50 \end{bmatrix}$$

使用最小二乘法：
$$A^T A = \begin{bmatrix} 3826.16 & 91.06 \\ 91.06 & 3 \end{bmatrix}$$

求解得：$a = 0.9877$，$b = -0.0088m$
</details>

**2. 温度补偿计算**
已知温度补偿系数$\alpha_T = 3.2 \times 10^{-5}/°C$，参考温度20°C。当前温度-10°C，测量距离100m，计算补偿后的距离。

*Hint: 使用线性温度补偿公式。*

<details>
<summary>答案</summary>

温度差：$\Delta T = -10 - 20 = -30°C$

补偿系数：$1 + \alpha_T \Delta T = 1 + 3.2 \times 10^{-5} \times (-30) = 0.99904$

补偿后距离：$d_{comp} = 100 \times 0.99904 = 99.904m$
</details>

**3. 外参旋转矩阵验证**
给定旋转矩阵$R$，如何验证其是否为有效的旋转矩阵？列出需要检查的条件。

*Hint: 考虑旋转矩阵的基本性质。*

<details>
<summary>答案</summary>

有效旋转矩阵需满足：
1. 正交性：$R^T R = I$
2. 行列式为1：$\det(R) = 1$
3. 各行、列向量模长为1
4. 数值检查：$\|R^T R - I\|_F < \epsilon$（如$\epsilon = 10^{-6}$）
</details>

**4. 标定质量评估**
某激光雷达与相机标定后，重投影误差为3.5像素。相机分辨率1920×1080，焦距800像素。评估此标定质量。

*Hint: 考虑像素误差对应的角度误差。*

<details>
<summary>答案</summary>

角度误差：$\theta = \arctan(\frac{3.5}{800}) = 0.25°$

相对误差：$\frac{3.5}{1920} = 0.18\%$（相对于图像宽度）

评估：重投影误差偏大（目标<2像素），建议重新标定或检查标定数据质量。
</details>

### 挑战题

**5. 多激光雷达系统标定优化**
三个激光雷达呈三角形布置，相互间有重叠视野。设计一个全局优化算法，同时标定三个雷达间的相对外参。考虑如何处理标定中的尺度不一致问题。

*Hint: 构建因子图，考虑闭环约束。*

<details>
<summary>答案</summary>

1. 构建因子图：
   - 节点：三个激光雷达的位姿
   - 边：两两之间的相对变换观测

2. 优化目标：
   $$\min \sum_{i<j} \|T_i \cdot T_{ij}^{obs} - T_j\|^2 + \lambda \|T_1 \cdot T_{12} \cdot T_{23} \cdot T_{31} - I\|^2$$

3. 尺度一致性：
   - 使用已知距离的标定物
   - 或固定一对雷达间的距离作为尺度基准

4. 迭代优化：
   - 初始化：使用两两ICP结果
   - 使用g2o或Ceres求解
   - 验证闭环误差<1cm
</details>

**6. 在线标定算法设计**
设计一个基于深度学习的在线标定质量评估网络。输入为连续10帧点云，输出为标定质量分数和建议的参数调整量。

*Hint: 考虑使用PointNet++提取特征，结合时序信息。*

<details>
<summary>答案</summary>

网络架构：
1. 特征提取：PointNet++处理每帧点云
2. 时序融合：LSTM处理10帧特征序列
3. 质量评估头：输出0-1质量分数
4. 参数回归头：输出6-DOF调整量

训练策略：
- 数据增强：添加标定误差
- 损失函数：质量分类损失 + 参数回归损失
- 真值标签：通过离线高精度标定获得

部署考虑：
- 模型量化减少计算量
- 滑动窗口实时处理
- 输出平滑避免震荡
</details>

**7. 温度自适应补偿**
激光雷达在极端温度循环测试中（-40°C到+85°C），发现温度补偿模型存在非线性。设计一个自适应算法，在线学习温度-误差曲线。

*Hint: 使用递归最小二乘或卡尔曼滤波。*

<details>
<summary>答案</summary>

自适应算法设计：

1. 扩展温度模型：
   $$d_{comp} = d_{meas}[1 + \sum_{i=1}^{n} a_i T^i]$$

2. 递归最小二乘(RLS)更新：
   ```
   K = P·φ/(λ + φᵀ·P·φ)
   e = d_true - φᵀ·θ
   θ = θ + K·e
   P = (P - K·φᵀ·P)/λ
   ```
   其中φ为温度特征向量[1,T,T²,...]

3. 自适应策略：
   - 遗忘因子λ=0.95-0.99
   - 温度变化率大时减小λ
   - 稳定后增大λ防止过拟合

4. 实时验证：
   - 保留验证数据集
   - 监控预测误差
   - 异常时回退到固定模型
</details>

**8. 标定传递误差分析**
在A→B→C→D的多传感器链式标定中，每步标定的旋转误差标准差为0.1°，平移误差为5mm。计算并分析A到D的总误差分布。

*Hint: 使用误差传播理论和蒙特卡洛仿真。*

<details>
<summary>答案</summary>

理论分析：
1. 旋转误差（小角度近似）：
   $$\sigma_{rot}^{total} = \sqrt{3} \times 0.1° = 0.173°$$

2. 平移误差（考虑耦合）：
   - 纯平移累积：$\sigma_t = \sqrt{3} \times 5mm = 8.66mm$
   - 旋转引起的平移误差需考虑杆臂效应

蒙特卡洛验证：
```python
# 伪代码
for i in range(10000):
    T_AB = 真值 + 高斯噪声(0.1°, 5mm)
    T_BC = 真值 + 高斯噪声(0.1°, 5mm)
    T_CD = 真值 + 高斯噪声(0.1°, 5mm)
    T_AD = T_AB @ T_BC @ T_CD
    记录误差

计算误差分布统计量
```

结果分析：
- 误差呈近似高斯分布
- 存在轻微的非线性效应
- 建议直接标定A-D减少累积误差
</details>